extends ../ui_layout-esp

block content
  -var cdn = "https://dhpd030vnpk29.cloudfront.net";
  .sixteen.wide.column
    h3.ui.header Información de perfil
    .ui.basic.segment(style="padding:10px 0;")
      img.ui.small.image.profileImage(src=cdn+"/profile_pictures/"+user.profile.picture)
      button.large.ui.labeled.icon.button.editProfilePictureButton(style="margin: 1em 0;")
        i.plus.icon
        |  Elige una foto de perfil
    form.ui.form(action='/account/profile/'+mod, method='POST', enctype='multipart/form-data')
      input(type='hidden', name='_csrf', value=csrfToken)
      input(type='hidden', name='profilePhoto', value=user.profile.picture)
      .field(data-tooltip="Recuerda que esta información se almacena en el sitio hasta que termine la lección. Piensa en usar un apodo o un alias en lugar de tu nombre real." data-position="bottom left")
        label(for='name') Nombre
        input.form-control(type='text', name='name', id='name', value=user.profile.name)
      .field(data-tooltip="Recuerda que esta información se almacena en el sitio hasta que termine la lección. Piensa en usar otra ubicación en lugar de tu ubicación real." data-position="bottom left")
        label(for='location') Ubicación (Ciudad/País)
        input.form-control(type='text', name='location', id='location', value=user.profile.location)
      .field
        label(for='bio') Bio
        textarea(rows='2', name='bio', id='bio')=user.profile.bio
      button.ui.green.button(type='submit' style="margin-bottom:8em;") Actualiza tu perfil
      
      
  //- Profile Picture Selection Modal 
  .ui.small.long.post.modal.profilePictureModal(style="margin:95px 0;")  
    i.close.icon  
    .header Elige una foto de perfil 
    .content  
      form.ui.profilePicForm.form 
        .ui.segment
            .three.fields
              .field
                .ui.radio.checkbox
                  input#photoOne.hidden(type='radio' name='profilepicinput' value="bballprofpic.png")
                  label
                      img.lazy(src='/images/picture.svg' data-src=cdn+"/profile_pictures/bballprofpic.png")
              .field
                .ui.radio.checkbox
                  input#photoTwo.hidden(type='radio' name='profilepicinput' value="boatprofpic.png")
                  label
                      img.lazy(src='/images/picture.svg' data-src=cdn+"/profile_pictures/boatprofpic.png")
              .field
                .ui.radio.checkbox
                  input#photoThree.hidden(type='radio' name='profilepicinput' value="cakeprofpic.png")
                  label
                      img.lazy(src='/images/picture.svg' data-src=cdn+"/profile_pictures/cakeprofpic.png") 
            .three.fields
              .field
                .ui.radio.checkbox
                  input#photoOne.hidden(type='radio' name='profilepicinput' value="carprofpic.png")
                  label
                      img.lazy(src='/images/picture.svg' data-src=cdn+"/profile_pictures/carprofpic.png")
              .field
                .ui.radio.checkbox
                  input#photoTwo.hidden(type='radio' name='profilepicinput' value="catprofpic.png")
                  label
                      img.lazy(src='/images/picture.svg' data-src=cdn+"/profile_pictures/catprofpic.png")
              .field
                .ui.radio.checkbox
                  input#photoThree.hidden(type='radio' name='profilepicinput' value="flowerprofpic.png")
                  label
                      img.lazy(src='/images/picture.svg' data-src=cdn+"/profile_pictures/flowerprofpic.png")  
            .three.fields
              .field
                .ui.radio.checkbox
                  input#photoOne.hidden(type='radio' name='profilepicinput' value="pencilprofpic.png")
                  label
                      img.lazy(src='/images/picture.svg' data-src=cdn+"/profile_pictures/pencilprofpic.png")
              .field
                .ui.radio.checkbox
                  input#photoTwo.hidden(type='radio' name='profilepicinput' value="sparkprofpic.png")
                  label
                      img.lazy(src='/images/picture.svg' data-src=cdn+"/profile_pictures/sparkprofpic.png")
              .field
                .ui.radio.checkbox
                  input#photoThree.hidden(type='radio' name='profilepicinput' value="wolfprofpic.png")
                  label
                      img.lazy(src='/images/picture.svg' data-src=cdn+"/profile_pictures/wolfprofpic.png")  
      
            
        .ui.error.message#noPhotoError 
          | Por favor, elige una foto de perfil
    .actions  
      .ui.green.approve.button.labeled.icon
        i.check.icon
        |  Subir
      .ui.red.deny.button.labeled.icon
        i.close.icon
        |  Cancelar

block scripts
  script.
    const cdn = "https://dhpd030vnpk29.cloudfront.net"
    $('.editProfilePictureButton').on('click', function(){
      $('.profilePictureModal').modal({
        onApprove: function() {
          let imageName = $('input[name="profilepicinput"]:checked').val();
          console.log(imageName);
          if(imageName !== undefined){
            $('#noPhotoError').hide();
            let srcString = cdn + '/profile_pictures/' + imageName;
            $('.profileImage').attr('src', srcString);
            $('input[name="profilePhoto"]').val(imageName);
            return true;
          } else {
            $('#noPhotoError').show();
            return false;
          }
        },
        onDeny: function(){
          return true;
        }
      }).modal('show');
    });
      
    $('input:radio[name="profilepicinput"]').change(function(){
      $('#noPhotoError').hide();
    });

block styles
  style(type='text/css').
    .lazy {
      width: 90%;
      height: 90%;
    }
